#ifndef NETWORKCLASSREGISTRY_H
#define NETWORKCLASSREGISTRY_H

#include "pandabase.h"
#include "pvector.h"
#include "pmap.h"

class NetworkClass;

/**
 *
 */
class NetworkClassRegistry {
public:
  void register_class(NetworkClass *cls);
  void build_ids();

  inline NetworkClass *get_class_by_name(const std::string &name) const;
  inline NetworkClass *get_class_by_id(uint16_t id) const;

  inline size_t get_num_classes() const;
  inline NetworkClass *get_class(size_t n) const;

private:
  typedef pvector<NetworkClass *> Classes;
  typedef pflat_hash_map<uint16_t, NetworkClass *> ClassesByID;
  typedef pflat_hash_map<std::string, NetworkClass *> ClassesByName;
  Classes _classes;
  ClassesByID _classes_by_id;
  ClassesByName _classes_by_name;

public:
  inline static NetworkClassRegistry *ptr();

private:
  static NetworkClassRegistry *_ptr;
};

/**
 *
 */
inline NetworkClass *
NetworkClassRegistry::get_class_by_name(const std::string &name) const {
  ClassesByName::const_iterator it = _classes_by_name.find(name);
  if (it != _classes_by_name.end()) {
    return (*it).second;
  }
  return nullptr;
}


/**
 * 
 */


/**
 *
 */
inline NetworkClassRegistry *NetworkClassRegistry::
ptr() {
  if (_ptr == nullptr) {
    _ptr = new NetworkClassRegistry;
  }
  return _ptr;
}

#endif // NETWORKCLASSREGISTRY_H
